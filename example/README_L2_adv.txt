#######################################################
#
# 명령어 사용 예시
# make_pkt_l2.py [-h|--help] [-t|--time=<delay_interval_ms>] [-e|--etype=<hex>] [-o|--output=<PCAP_NAME>] [-l|--loop=<loop_count>] (rule_file)
#
# -t or --time    => 페이로드 사이의 지연 시간 설정     (기본: 0ms)
# -e or --etype   => L2 Ethernet Layer의 Type 값      (기본: 0x0800)
# -l or --loop    => 페이로드 반복 횟수                    (기본: 1)
# -o or --output  => 페이로드를 담은 PCAP의 output명  (기본: output.pcap)
#
# 실행 예시: ./make_pkt_l2.py --etype=0x88a4 -o ETHERCAT_L2.pcap ECAT.txt
# -> PCAP 파일의 이름은 ETHERNET_L2.pcap으로 설정하고, Ethernet Type은 0x88a4, Rule 파일은 ECAT.txt이다.
#
#######################################################

#######################################################
# PCAP Rule 입력 예시
#
#
# 1) 페이로드 입력 방법
# 패킷의 순서대로 한줄씩 입력해주되, 아래와 같이 입력
#                                                |---------------------------- 페이로드 1-N까지 전부 연결되서 제작됨 --------------------------|
# (SRC 맥 주소 or 변수명) (DST 맥 주소 or 변수명) (페이로드 hexstring) (페이로드 hexstring 2) (페이로드 hexstring 3...) ... (페이로드 hexstring N)
# 맥 주소는 AA:BB:CC:DD:EE:FF 또는 aabbccddeeff 형태로 입력하면 되고, 변수를 지정해 축약해서 사용 가능
# (변수) = (맥 주소)
# 
#######################################################

# Created Date: 2023.02.15 | Ruskonert
# 변수 설정
M      = 00:18:7d:ff:06:01
S      = 00:18:7d:ff:06:02
BCAST  = ff:ff:ff:ff:ff:ff

# 입력 예시 1
M BCAST 0e100702000030010200000000000000000000000000000000000000000000000000000000000000000000000000
S BCAST 0e100702050030010200040008000500000000000000000000000000000000000000000000000000000000000000

# 입력 예시 2
00:18:7d:ff:06:01 ff:ff:ff:ff:ff:ff 62100803000020010280000011000000070400003001028000000000000001050000300102800000000000000106ffff300102800000000000000107feff300102800000000000000108fdff300102800000000000000109fcff30010200000000000000
00:18:7d:ff:06:02 ff:ff:ff:ff:ff:ff 62100803050020010280040011000500070405003001028004000800050001050500300102800400080001000106040030010280040008000100010703003001028004000800010001080200300102800400080001000109010030010200040008000100

# 입력 예시 3
00:18:7d:ff:06:01 BCAST 6110080a0000010101800000000000070b000030010280000000000000010c000030010280000000000000010dffff30010280000000000000010efeff30010280000000000000010ffdff300102800000000000000110fcff30010200000000000000
00:18:7d:ff:06:02 BCAST 6110080a0500010101800400000500070b050030010280040019000500010c050030010280040011000100010d040030010280040011000100010e030030010280040011000100010f0200300102800400080001000110010030010200040008000100

# 입력 예시 4
00187dff0601 BCAST 62100711000030010280000000000000071200003001028000000000000001130000300102800000000000000114ffff300102800000000000000115feff300102800000000000000116fdff300102800000000000000117fcff30010200000000000000
00187dff0602 BCAST 62100711050030010280040011000500071205003001028004001100050001130500300102800400110001000114040030010280040011000100011503003001028004001100010001160200300102800400010001000117010030010200040001000100

# 입력 예시 5
00187dff0601 BCAST 6011 081800000006008100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000719000030010280000000000000011a000030010280000000000000011bffff30010280000000000000011cfeff30010280000000000000011dfdff30010280000000000000011efcff30010200000000000000
00:18:7d:ff:06:02 BCAST 6011 081f0000000800810000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000072000003001028000000000000001210000300102800000000000000122ffff300102800000000000000123feff300102800000000000000124fdff300102800000000000000125fcff30010200000000000000
